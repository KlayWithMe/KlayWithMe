{"ast":null,"code":"var _jsxFileName = \"/Users/alvinlee/Git_Folder/blockchainAppDebv/client/src/pages/myProfile/MyProfile.jsx\",\n    _s = $RefreshSig$();\n\nimport Post from \"../../components/post/Post\";\nimport * as CaverAPI from \"../../api/UseCaver\";\nimport { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport UserDetail from \"../../components/userDetail/UserDetail\";\nimport styles from \"./MyProfile.module.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MyProfile() {\n  _s();\n\n  // User\n  const {\n    user: currentUser,\n    myAddress: walletAddress,\n    setMyBalance\n  } = useContext(AuthContext);\n  let idx = 0; // Post\n\n  const [myPosts, setMyPosts] = useState([]); // NFTs\n\n  const [myNFTs, setMyNFTs] = useState([]); // User\n\n  const {\n    user\n  } = useContext(AuthContext); // Tab\n\n  const [tab, setTab] = useState(\"My Posts\");\n  useEffect(() => {\n    // fetch DB posts\n    const fetchMyPosts = async () => {\n      const response = await axios.get(\"/posts/user/\" + user._id);\n\n      if (response && response.data) {\n        setMyPosts(response.data.sort((p1, p2) => {\n          return new Date(p2.createdAt) - new Date(p1.createdAt);\n        }));\n      }\n    }; // fetch NFT posts\n\n\n    const fetchMyNFTs = async () => {\n      if (!user) {\n        alert(\"fetch nfts error: no user\");\n        return;\n      }\n\n      const _nftURLs = await axios.put(\"/klaytn/info/\" + walletAddress);\n\n      let _nftPosts = [];\n\n      for (let i = 0; i < _nftURLs.data.length; i++) {\n        const _nft = await axios.get(_nftURLs.data[i].uri);\n\n        if (_nft.data == null) {\n          continue;\n        } else {\n          _nftPosts.push(_nft.data);\n        }\n      } // console.log(_nftPosts)\n\n\n      setMyNFTs(_nftPosts);\n    }; // const fetchMyNFTs = async () => {\n    //   if (!user) {\n    //     alert(\"fetch nfts error: no user\");\n    //     return;\n    //   }\n    //   const _nfts = await CaverAPI.fetchCardOf(user.walletAddress);\n    //   let _nftPosts = [];\n    //   for (let i = 0; i < _nfts.length; i++) {\n    //     const response = await axios.get(_nfts[i].uri)\n    //       .catch(function (error) {\n    //       })\n    //     if (response && response.data) {\n    //       _nftPosts.push(response.data);\n    //     }\n    //   }\n    //   setMyNFTs(_nftPosts);\n    //   console.log(_nftPosts);\n    // }\n\n\n    fetchMyPosts();\n    fetchMyNFTs();\n  }, []);\n\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: alert(\"NO USER\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"userProfile\",\n      children: /*#__PURE__*/_jsxDEV(UserDetail, {\n        user: user\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.tabContainer,\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: styles.tabButton,\n        onClick: () => {\n          setTab(\"My Posts\");\n        },\n        children: \" My Posts \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: styles.tabButton,\n        onClick: () => {\n          setTab(\"My NFTs\");\n        },\n        children: \" My NFTs \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), // (\n    //   <Post key={p._id} index={idx++} post={p} />\n    // )\n    tab === \"My Posts\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.postContainer,\n      children: myPosts.map(p => {\n        if (p.isNFT === false) return /*#__PURE__*/_jsxDEV(Post, {\n          index: idx++,\n          post: p\n        }, p._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 25\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }, this) : null, tab === \"My NFTs\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.postContainer,\n      children: myNFTs.map(p => /*#__PURE__*/_jsxDEV(Post, {\n        index: idx++,\n        post: p\n      }, p._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 15\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MyProfile, \"gP4osE5Fx8zVDSgUFle4vdrvmN4=\");\n\n_c = MyProfile;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyProfile\");","map":{"version":3,"names":["Post","CaverAPI","useEffect","useState","useContext","axios","AuthContext","UserDetail","styles","MyProfile","user","currentUser","myAddress","walletAddress","setMyBalance","idx","myPosts","setMyPosts","myNFTs","setMyNFTs","tab","setTab","fetchMyPosts","response","get","_id","data","sort","p1","p2","Date","createdAt","fetchMyNFTs","alert","_nftURLs","put","_nftPosts","i","length","_nft","uri","push","container","tabContainer","tabButton","postContainer","map","p","isNFT"],"sources":["/Users/alvinlee/Git_Folder/blockchainAppDebv/client/src/pages/myProfile/MyProfile.jsx"],"sourcesContent":["import Post from \"../../components/post/Post\";\nimport * as CaverAPI from \"../../api/UseCaver\";\nimport { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport UserDetail from \"../../components/userDetail/UserDetail\";\nimport styles from \"./MyProfile.module.scss\"\n\nexport default function MyProfile() {\n  // User\n  const { user: currentUser, myAddress: walletAddress, setMyBalance } = useContext(AuthContext);\n  let idx = 0;\n\n  // Post\n  const [myPosts, setMyPosts] = useState([]);\n  // NFTs\n  const [myNFTs, setMyNFTs] = useState([]);\n  // User\n  const { user } = useContext(AuthContext);\n  // Tab\n  const [tab, setTab] = useState(\"My Posts\");\n\n  useEffect(() => {\n    // fetch DB posts\n    const fetchMyPosts = async () => {\n      const response = await axios.get(\"/posts/user/\" + user._id);\n      if (response && response.data) {\n        setMyPosts(\n          response.data.sort((p1, p2) => {\n            return new Date(p2.createdAt) - new Date(p1.createdAt);\n          })\n        );\n      }\n    }\n\n    // fetch NFT posts\n    const fetchMyNFTs = async () => {\n      if (!user) {\n        alert(\"fetch nfts error: no user\");\n        return ;\n      }\n      const _nftURLs = await axios.put(\"/klaytn/info/\" + walletAddress);\n      let _nftPosts = [];\n      for (let i = 0; i < _nftURLs.data.length; i++) {\n        const _nft = await axios.get(_nftURLs.data[i].uri)\n        if (_nft.data == null) {\n          continue;\n        } else {\n          _nftPosts.push(_nft.data)\n        }\n      }\n      // console.log(_nftPosts)\n      setMyNFTs(_nftPosts)\n    }\n    // const fetchMyNFTs = async () => {\n    //   if (!user) {\n    //     alert(\"fetch nfts error: no user\");\n    //     return;\n    //   }\n    //   const _nfts = await CaverAPI.fetchCardOf(user.walletAddress);\n    //   let _nftPosts = [];\n    //   for (let i = 0; i < _nfts.length; i++) {\n    //     const response = await axios.get(_nfts[i].uri)\n    //       .catch(function (error) {\n    //       })\n    //     if (response && response.data) {\n    //       _nftPosts.push(response.data);\n    //     }\n    //   }\n    //   setMyNFTs(_nftPosts);\n    //   console.log(_nftPosts);\n    // }\n\n    fetchMyPosts();\n    fetchMyNFTs();\n  }, []);\n\n  if (!user) {\n    return (<div>{alert(\"NO USER\")}</div>);\n  }\n\n  return (\n    <div className={styles.container}>\n      <div className=\"userProfile\">\n        <UserDetail user={user} />\n      </div>\n      <div className={styles.tabContainer}>\n        <button className={styles.tabButton} onClick={() => { setTab(\"My Posts\") }}> My Posts </button>\n        <button className={styles.tabButton} onClick={() => { setTab(\"My NFTs\") }}> My NFTs </button>\n      </div>\n      {\n        // (\n        //   <Post key={p._id} index={idx++} post={p} />\n        // )\n        tab === \"My Posts\" ?\n          <div className={styles.postContainer}>\n            {myPosts.map((p) => {\n              if (p.isNFT === false)\n                return (<Post key={p._id} index={idx++} post={p} />);\n            })}\n          </div> : null\n      }\n      {\n        tab === \"My NFTs\" ?\n          <div className={styles.postContainer}>\n            {myNFTs.map((p) => (\n              <Post key={p._id} index={idx++} post={p} />\n            ))}\n          </div> : null\n      }\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}